# Оценка безопасности проекта

## Текущее состояние

### Реализовано

| Область | Статус |
|---------|--------|
| Пароли | bcrypt — хеширование |
| SQL | Параметризованные запросы (?) — нет SQL-инъекций |
| Права доступа | Проверки canEdit, canDelete, canChangeStatus |
| Токен в приложении | Только в памяти, logout очищает |
| **JWT** | ✅ Подпись, срок 24ч (config.JWT_SECRET) |
| **Rate limiting** | ✅ 5 попыток / 15 мин на login |
| **CORS** | ✅ CORS_ORIGINS — список origins (если задан) |
| **Валидация** | ✅ title≤200, description≤5000, фото JPEG/PNG≤5MB, ≤10 фото |
| **Body limit** | ✅ 12 MB (config.BODY_LIMIT) |

---

## Остаётся сделать

### HTTP вместо HTTPS (инфраструктура)

**Проблема:** Трафик не шифруется. Логин, пароль и токен передаются в открытом виде.

**Рекомендация:** Настроить HTTPS (Nginx + Let's Encrypt) и в `api_config.dart` использовать `https://`.

---

## Низкие риски

### 8. Токен и пароль в памяти приложения

**Проблема:** Токен хранится только в памяти — при закрытии приложения сессия теряется. Это приемлемо с точки зрения безопасности, но неудобно для пользователя.

**Рекомендация:** При необходимости «запомнить меня» — хранить токен в flutter_secure_storage (зашифрованное хранилище), а не в SharedPreferences.

---

### 9. API URL в коде приложения

**Проблема:** Адрес сервера захардкожен в `api_config.dart`. При сборке APK его можно извлечь.

**Рекомендация:** Для публичного приложения — не критично. Для повышенной конфиденциальности — использовать переменные окружения при сборке или удалённую конфигурацию.

---

### 10. Демо-логины в документации

**Проблема:** admin/admin123 и т.п. описаны в README. Если БД не переинициализирована после деплоя, эти пароли остаются.

**Рекомендация:** После первого деплоя сменить пароли или удалить демо-пользователей.

---

## Приоритеты

| # | Действие | Статус |
|---|----------|--------|
| 1 | HTTPS (Nginx + SSL) | Остаётся |
| 2 | JWT вместо base64-токена | ✅ |
| 3 | Rate limiting на login | ✅ |
| 4 | Ограничение CORS | ✅ |
| 5 | Валидация фото (размер, тип) | ✅ |
| 6 | Валидация длины полей | ✅ |
| 7 | Снизить limit body | ✅ |
